{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-05-20T16:11:54.200046Z", "invocation_id": "c1dc5111-db37-496d-86e7-9016116c23d3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:52.134978Z", "completed_at": "2025-05-20T16:11:52.176475Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:52.177211Z", "completed_at": "2025-05-20T16:11:52.291557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15813922882080078, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_customer", "compiled": true, "compiled_code": "\n\nwith customers as (\n    select\n        customer_id,\n        store_id,\n        first_name as customer_first_name,\n        last_name as customer_last_name,\n        address_id,\n        email as customer_email,\n        active as customer_active,\n        create_date as customer_create_date,\n        last_update as customer_last_update\n    from `sakila_dwh`.`customer`\n),\n\naddress as (\n    select * from `sakila_dwh`.`address`\n),\n\ncity as (\n    select * from `sakila_dwh`.`city`\n),\n\ncountry as (\n    select * from `sakila_dwh`.`country`\n)\n\nselect \n    lower(hex(MD5(toString(coalesce(cast(sc.customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sc.customer_last_update as String), '_dbt_utils_surrogate_key_null_') )))) as customer_skey,\n    sc.customer_id,\n    sc.customer_first_name,\n    sc.customer_last_name,\n    sc.customer_email,\n    sc.customer_active,\n    sa.address as customer_address,\n    sa.district as customer_district,\n    sa.postal_code as customer_postal_code,\n    sa.phone as customer_phone_number,\n    scty.city as customer_city,\n    sctr.country as customer_country,\n    sc.customer_create_date,\n    sc.customer_last_update\nfrom customers sc\njoin address sa\n    on sc.address_id = sa.address_id\njoin city scty\n    on sa.city_id = scty.city_id\njoin country sctr\n    on scty.country_id = sctr.country_id", "relation_name": "`adw09_stag`.`stg_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:52.300391Z", "completed_at": "2025-05-20T16:11:52.312175Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:52.312956Z", "completed_at": "2025-05-20T16:11:52.357104Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.058922767639160156, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_film", "compiled": true, "compiled_code": "\n\nwith film_category as (\n    select\n        film_id,\n        category_id,\n        last_update as category_last_update\n    from `sakila_dwh`.`film_category`\n),\n\ncategory as (\n    select\n        category_id, \n        name as category_name\n    from `sakila_dwh`.`category`\n),\n\nlanguage as (\n    select\n        language_id,\n        name as language_name,\n        last_update\n    from `sakila_dwh`.`language`\n),\n\nfilm as (\n    select\n        film_id,\n        title as film_title,\n        description as film_description,\n        release_year as film_release_year,\n        language_id,\n        original_language_id,\n        rental_duration,\n        rental_rate,\n        length as film_duration,\n        replacement_cost as film_replacement_cost,\n        rating as film_rating,\n        special_features as film_special_features,\n        last_update as film_last_update\n    from `sakila_dwh`.`film`\n)\n\nselect\n    lower(hex(MD5(toString(coalesce(cast(f.film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.film_last_update as String), '_dbt_utils_surrogate_key_null_') )))) as film_skey, \n    f.film_id as film_id,\n    f.film_title,\n    f.film_description,\n    f.film_release_year,\n    l.language_name as film_language,\n    ol.language_name as film_original_language,\n    f.rental_duration as film_rental_duration,\n    f.rental_rate as film_rental_rate,\n    f.film_duration,\n    f.film_replacement_cost,\n    f.film_rating,\n    f.film_special_features,\n    c.category_name as film_category_name,\n    f.film_last_update\nfrom film f\njoin language l\n    on f.language_id = l.language_id\njoin language ol\n    on f.original_language_id = ol.language_id\njoin film_category fc\n    on f.film_id = fc.film_id\njoin category c\n    on fc.category_id = c.category_id", "relation_name": "`adw09_stag`.`stg_film`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:52.365045Z", "completed_at": "2025-05-20T16:11:52.377637Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:52.378690Z", "completed_at": "2025-05-20T16:11:52.415711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.053064584732055664, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_rentals", "compiled": true, "compiled_code": "\n\nwith rental as (\n    select *\n    from `sakila_dwh`.`rental`\n),\n\ninventory as (\n    select *\n    from `sakila_dwh`.`inventory`\n),\n\nstaff as (\n    select *\n    from `sakila_dwh`.`staff`\n)\n\nselect\n    r.rental_id,\n    r.customer_id,\n    i.film_id,\n    r.staff_id as staff_id,               \n    s.store_id as store_id,  \n    r.rental_date,\n    r.return_date,\n    1 as count_rentals,\n    datediff(day, r.rental_date, r.return_date) as rental_duration,\n    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r.last_update as String), '_dbt_utils_surrogate_key_null_') )))) as rental_skey\nfrom `sakila_dwh`.`rental` r\njoin `sakila_dwh`.`inventory` i on r.inventory_id = i.inventory_id\njoin `sakila_dwh`.`staff` s on r.staff_id = s.staff_id", "relation_name": "`adw09_stag`.`stg_rentals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:52.423544Z", "completed_at": "2025-05-20T16:11:52.433931Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:52.434781Z", "completed_at": "2025-05-20T16:11:52.482865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.061194658279418945, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_staff", "compiled": true, "compiled_code": "\n\nwith staff as (\n    select\n        staff_id,\n        first_name,\n        last_name,\n        address_id,\n        email,\n        store_id,\n        active,\n        last_update\n    from `sakila_dwh`.`staff`\n),\n\naddress as (\n    select * from `sakila_dwh`.`address`\n),\n\ncity as (\n    select * from `sakila_dwh`.`city`\n),\n\ncountry as (\n    select * from `sakila_dwh`.`country`\n)\n\nselect \n    lower(hex(MD5(toString(coalesce(cast(s.staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.last_update as String), '_dbt_utils_surrogate_key_null_') )))) as staff_skey,\n    s.staff_id,\n    s.first_name as staff_first_name,\n    s.last_name as staff_last_name,\n    a.address as staff_address,\n    a.district as staff_district,\n    a.postal_code as staff_postal_code,\n    a.phone as staff_phone_number,\n    c.city as staff_city,\n    co.country as staff_country,\n    s.email as staff_email,\n    s.store_id,\n    s.active as staff_active,\n    s.last_update as staff_last_update\nfrom staff s\njoin address a \n    on s.address_id = a.address_id\njoin city c \n    on a.city_id = c.city_id\njoin country co \n    on c.country_id = co.country_id", "relation_name": "`adw09_stag`.`stg_staff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:52.497791Z", "completed_at": "2025-05-20T16:11:52.511088Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:52.512476Z", "completed_at": "2025-05-20T16:11:52.558939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06321907043457031, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_store", "compiled": true, "compiled_code": "\n\nwith store as (\n    select\n        store_id,\n        manager_staff_id,\n        address_id,\n        last_update as store_last_update\n    from `sakila_dwh`.`store`\n),\n\nstaff as (\n    select\n        staff_id,\n        first_name as store_manager_first_name,\n        last_name as store_manager_last_name\n    from `sakila_dwh`.`staff`\n),\n\naddress as (\n    select *\n    from `sakila_dwh`.`address`\n),\n\ncity as (\n    select *\n    from `sakila_dwh`.`city`\n),\n\ncountry as (\n    select *\n    from `sakila_dwh`.`country`\n)\n\nselect\n    lower(hex(MD5(toString(coalesce(cast(ss.store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ss.store_last_update as String), '_dbt_utils_surrogate_key_null_') )))) as store_skey,\n    ss.store_id,\n    sa.address as store_address,\n    sa.district as store_district,\n    sa.postal_code as store_postal_code,\n    sa.phone as store_phone_number,\n    scty.city as store_city,\n    sctr.country as store_country,\n    ss.manager_staff_id as store_manager_staff_id,\n    sst.store_manager_first_name,\n    sst.store_manager_last_name,\n    ss.store_last_update\nfrom store ss\njoin address sa\n    on ss.address_id = sa.address_id\njoin city scty\n    on sa.city_id = scty.city_id\njoin country sctr\n    on scty.country_id = sctr.country_id\njoin staff sst\n    on ss.manager_staff_id = sst.staff_id", "relation_name": "`adw09_stag`.`stg_store`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:52.566268Z", "completed_at": "2025-05-20T16:11:52.592654Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:52.593427Z", "completed_at": "2025-05-20T16:11:53.169969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6055912971496582, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_customer", "compiled": true, "compiled_code": "\n\nSELECT\n    customer_skey,\n    customer_id,\n    customer_first_name,\n    customer_last_name,\n    customer_email,\n    customer_active,\n    customer_address,\n    customer_district,\n    customer_postal_code,\n    customer_phone_number,\n    customer_city,\n    customer_country,\n    customer_create_date,\n    customer_last_update\nFROM `adw09_stag`.`stg_customer`\n\n\nWHERE customer_last_update > (SELECT max(customer_last_update) FROM `adw09_star`.`dim_customer`)\n", "relation_name": "`adw09_star`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:53.176944Z", "completed_at": "2025-05-20T16:11:53.184027Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:53.184771Z", "completed_at": "2025-05-20T16:11:53.495503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32024121284484863, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_film", "compiled": true, "compiled_code": "\n\nSELECT\n    film_skey,\n    film_id,\n    film_title,\n    film_description,\n    film_release_year,\n    film_language,\n    film_original_language,\n    film_rental_duration,\n    film_rental_rate,\n    film_duration,\n    film_replacement_cost,\n    film_rating,\n    film_special_features,\n    film_category_name,\n    film_last_update\nFROM `adw09_stag`.`stg_film`\n\n\nWHERE film_last_update > (SELECT max(film_last_update) FROM `adw09_star`.`dim_film`)\n", "relation_name": "`adw09_star`.`dim_film`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:53.502495Z", "completed_at": "2025-05-20T16:11:53.509061Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:53.510001Z", "completed_at": "2025-05-20T16:11:53.782624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2825031280517578, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_staff", "compiled": true, "compiled_code": "\n\nSELECT\n    staff_skey,\n    staff_id,\n    staff_first_name,\n    staff_last_name,\n    staff_email,\n    store_id,\n    staff_active,\n    staff_last_update\nFROM `adw09_stag`.`stg_staff`\n\n\nWHERE staff_last_update > (SELECT max(staff_last_update) FROM `adw09_star`.`dim_staff`)\n", "relation_name": "`adw09_star`.`dim_staff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:53.789979Z", "completed_at": "2025-05-20T16:11:53.800122Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:53.800882Z", "completed_at": "2025-05-20T16:11:54.131064Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3434183597564697, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_store", "compiled": true, "compiled_code": "\n\nSELECT\n    store_skey,\n    store_id,\n    store_address,\n    store_district,\n    store_postal_code,\n    store_phone_number,\n    store_city,\n    store_country,\n    store_manager_staff_id,\n    store_manager_first_name,\n    store_manager_last_name,\n    store_last_update\nFROM `adw09_stag`.`stg_store`\n\n\nWHERE store_last_update > (SELECT max(store_last_update) FROM `adw09_star`.`dim_store`)\n", "relation_name": "`adw09_star`.`dim_store`"}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-05-20T16:11:54.138887Z", "completed_at": "2025-05-20T16:11:54.149179Z"}, {"name": "execute", "started_at": "2025-05-20T16:11:54.150000Z", "completed_at": "2025-05-20T16:11:54.178746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05267167091369629, "adapter_response": {}, "message": "Database Error in model fct_rentals (models/marts/fact/fct_rentals/fct_rentals.sql)\n  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 1\n   Code: 1. DB::Exception: Resolved identifier 'rental_date' in parent scope to expression 'adw09_stag.stg_rentals.rental_date' with correlated column 'rental_date' (Enable 'allow_experimental_correlated_subqueries' setting to allow correlated subqueries execution). In scope (SELECT max(rental_date) FROM adw09_star.fct_rentals). (UNSUPPORTED_METHOD) (version 25.4.1.2934 (official build))", "failures": null, "unique_id": "model.sakstar.fct_rentals", "compiled": true, "compiled_code": "\n\nwith stg_rentals as (\n    select\n        rental_id,\n        customer_id,\n        film_id,\n        staff_id,\n        rental_date,\n        count_rentals,\n        rental_duration\n    from `adw09_stag`.`stg_rentals`\n    \n    where rental_date > (select max(rental_date) from `adw09_star`.`fct_rentals`)\n    \n),\n\ndim_customer as (\n    select customer_id, customer_skey\n    from `adw09_star`.`dim_customer`\n),\n\ndim_film as (\n    select film_id, film_skey\n    from `adw09_star`.`dim_film`\n),\n\ndim_staff as (\n    select staff_id, staff_skey, store_id\n    from `adw09_star`.`dim_staff`\n),\n\ndim_store as (\n    select store_id, store_skey\n    from `adw09_star`.`dim_store`\n),\n\ndim_date as (\n    select date_actual, date_key\n    from `adw09_star`.`dim_date`\n)\n\nselect\n    lower(hex(MD5(toString(coalesce(cast(stg_rentals.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) as rental_skey,\n    dim_customer.customer_skey,\n    dim_film.film_skey,\n    dim_staff.staff_skey,\n    dim_store.store_skey,\n    dim_date.date_key,\n    stg_rentals.rental_id,\n    stg_rentals.count_rentals,\n    stg_rentals.rental_duration\nfrom stg_rentals\nleft join dim_customer\n    on stg_rentals.customer_id = dim_customer.customer_id\nleft join dim_film\n    on stg_rentals.film_id = dim_film.film_id\nleft join dim_staff\n    on stg_rentals.staff_id = dim_staff.staff_id\nLEFT JOIN dim_store \n    ON dim_staff.store_id = dim_store.store_id\nleft join dim_date\n    on cast(stg_rentals.rental_date as date) = dim_date.date_actual", "relation_name": "`adw09_star`.`fct_rentals`"}], "elapsed_time": 3.2065646648406982, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "print": true, "log_level": "info", "empty": false, "quiet": false, "printer_width": 80, "version_check": true, "static_parser": true, "profiles_dir": "/home/jovyan/dbt/workspace", "log_level_file": "debug", "cache_selected_only": false, "invocation_command": "dbt run", "populate_cache": true, "show_resource_report": false, "project_dir": "/home/jovyan/dbt/workspace", "introspect": true, "warn_error_options": {"include": [], "exclude": []}, "enable_legacy_logger": false, "favor_state": false, "exclude": [], "defer": false, "partial_parse": true, "write_json": true, "log_path": "/home/jovyan/dbt/workspace/logs", "partial_parse_file_diff": true, "indirect_selection": "eager", "macro_debugging": false, "send_anonymous_usage_stats": true, "log_format_file": "debug", "log_format": "default", "which": "run", "use_colors_file": true, "vars": {}, "require_resource_names_without_spaces": false, "strict_mode": false, "log_file_max_bytes": 10485760, "use_colors": true, "select": []}}